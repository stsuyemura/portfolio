function providePlugin(a,b){var c=window[window.GoogleAnalyticsObject||"ga"];c&&c("provide",a,b)}function get_intersect(a,b){var f,g,c=[],d={},e=b.length;for(f=0;e>f;f++)d[b[f]]=!0;for(e=a.length,f=0;e>f;f++)g=a[f],g in d&&c.push(g);return c}function read_cookie(a){var b=a+"=",c=String(document.cookie).split(";");for(var d in c){for(var e=String(c[d]);" "==e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(b))return e.substring(b.length,e.length)}return null}function set_cookie(a,b,c,d){var e,f=new Date;f.setTime(f.getTime()+1e3*60*60*24*c),e="; expires="+f.toGMTString(),document.cookie="none"==d?a+"="+b+e+";path=/;":a+"="+b+e+";path=/;domain="+d}var DRAttribution=function(a,b){ this.tracker=a,this.current_timestamp=Math.round((new Date).getTime()/1e3),this.domain_name=this.tracker.get("cookieDomain")||document.domain,this.session_timeout=parseInt(60*60*(b.hours||0),10)+parseInt(60*(b.minutes||30),10),this.campaign_timeout=parseInt(b.days||0,10)+parseInt(30*(b.months||6),10),this.wm_organic_sources=["google","daum","eniro","naver","yahoo","msn","bing","aol","lycos","ask","altavista","netscape","cnn","about","mamma","alltheweb","voila","virgilio","live","baidu","alice","yandex","najdi","mama","seznam","search","wirtulana polska","onetcenter","szukacz","yam","pchome","kvasir","sesam","ozu","terra","mynet","ekolay","rambler"],this.wm_social_sources=["facebook","pinterest","twitter","buzzfeed","linkedin","blogger","blogspot","reddit","tumblr","stumbleupon","tinyurl","polyvore","youtube","yelp","cafemom","flickr","paper.li","wordpress","getpocket","weebly","delicious","netvibes","plurk","typepad","vk","allvoices","badoo","disqus","livefyre","d.hatena"],this.wm_custom_social=["t.co","plus.google.com","plus.url.google.com","bookmarks.yahoo.com","answers.yahoo.com"],this._wma={tracking_id:"",timestamp:this.current_timestamp,source:"",medium:"",keyword:"",content:"",campaign:"",landing_page:window.location.href},this.url_parameters={utm_source:"source",utm_medium:"medium",utm_term:"keyword",utm_content:"content",utm_campaign:"campaign"},this.mediums=["none","referral","organic","social","paid"],this.init()};DRAttribution.prototype.init=function(){this.is_new_visitor()?(this._wma.tracking_id=parseInt(this.tracker.get("clientId").split(".")[0],10),this.get_info(),this.get_url_parameters(),set_cookie("_wma",JSON.stringify(this._wma),this.campaign_timeout,this.domain_name),set_cookie("_wmb",JSON.stringify(this._wma),this.campaign_timeout,this.domain_name),this.tracker.send("event","Unique User Info",this._wma.tracking_id,"","")):this.is_new_session()&&(location.hostname==document.referrer.split("/")[2]&&(this._wma=JSON.parse(read_cookie("_wma"))),this._wma.tracking_id=parseInt(this.tracker.get("clientId").split(".")[0],10),this.get_info(),this.get_url_parameters(),set_cookie("_wma",JSON.stringify(this._wma),this.campaign_timeout,this.domain_name),this.tracker.send("event","Unique User Info",this._wma.tracking_id,"",""))},DRAttribution.prototype.is_new_visitor=function(){return null===JSON.parse(read_cookie("_wma"))?!0:!1},DRAttribution.prototype.is_new_session=function(){var a=JSON.parse(read_cookie("_wma"));return this.current_timestamp>parseInt(a.timestamp,10)+this.session_timeout?!0:!1},DRAttribution.prototype.get_info=function(){if(this._wma.timestamp=this.current_timestamp,void 0===document.referrer||"undefined"===document.referrer||""===document.referrer)this._wma.medium="none",this._wma.source="direct";else if(location.hostname!=document.referrer.split("/")[2]){this._wma.source=document.referrer.split("/")[2];var a=this._wma.source.split(".");if(this.wm_custom_social.indexOf(this._wma.source)>0)this._wma.medium="social";else if(get_intersect(this.wm_organic_sources,a).length>0){var b=this.get_url_parameters(document.URL);if("gclid"in b)this._wma.medium="paid";else{this._wma.medium="organic",this._wma.keyword="not provided";var c=this.get_url_parameters(document.referrer);"q"in c&&(this._wma.keyword=c.q)}}else this._wma.medium=get_intersect(this.wm_social_sources,a).length>0?"social":"referral"}},DRAttribution.prototype.get_url_parameters=function(a){var c,d,e={};d=a?String(a.slice(a.indexOf("?")+1)).split("&"):String(window.location.href.slice(window.location.href.indexOf("?")+1)).split("&");for(var f in d)if(c=String(d[f]).split("="),e[c[0]]=c[1],c[0]in this.url_parameters){var g=this.url_parameters[c[0]];this._wma[g]=decodeURIComponent(c[1])}return e},providePlugin("DRAttribution",DRAttribution);